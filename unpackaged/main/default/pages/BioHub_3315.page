<apex:page applyHtmlTag="true" applyBodyTag="false" showHeader="false" docType="html-5.0" standardStylesheets="false" manifest="{!cacheUrlPrefix}/apex/BioHubCache_3315" controller="mobilecaddy1.MobileCaddyStartPageController001_mc">

    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
        <title>Bio Hub</title>

        <!-- ===================== -->
        <!-- Anonymous Logging     -->
        <!-- ===================== -->
        <script type="text/javascript">
            // Send an async GET to anonymous logging server
            var getUrl = 'https://mc-logs.herokuapp.com/log?log="Startpage loaded: ' + navigator.appVersion + '"';
            var xhr = new XMLHttpRequest();
            xhr.open('GET',getUrl, true);
            xhr.send();
        </script>
    
        <!-- ===================== -->
        <!-- Service Worker Setup  -->
        <!-- ===================== -->

        <script type="text/javascript">
          registerSW();
          function registerSW() {
            if ('serviceWorker' in navigator) {
              console.log("About to register sw");
              navigator.serviceWorker.register('{!cacheUrlPrefix}/apex/BioHubSW_3315')
              .then(function(registration) {
                console.log('Registration successful, scope is:', registration.scope);
              })
              .catch(function(error) {
                console.log('Service worker registration failed, error:', error);
              });
            }
          }
        </script>

        <!-- ===================== -->
        <!-- Your App's Resources  -->
        <!-- ===================== -->
        <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
        <script src="{!URLFOR($Resource.BioHub_3315, 'www/lib/js/signature_pad.min.js')}" type="text/javascript"></script>
        <script src="{!URLFOR($Resource.BioHub_3315, 'www/lib/js/ionic.bundle.min.js')}" type="text/javascript"></script>

        <script src="{!URLFOR($Resource.BioHub_3315, 'www/js/app.js')}" type="text/javascript"></script>
        <script src="{!URLFOR($Resource.BioHub_3315, 'www/js/services.js')}" type="text/javascript"></script>
        <script src="{!URLFOR($Resource.BioHub_3315, 'www/js/controllers.js')}" type="text/javascript"></script>
        <script src="{!URLFOR($Resource.BioHub_3315, 'www/lib/js/ng-cordova.min.js')}" type="text/javascript"></script>

        <!-- ============== -->
        <!-- Your App's CSS -->
        <!-- ============== -->
        <link rel="stylesheet" href="{!URLFOR($Resource.BioHub_3315, 'www/css/app.css')}"/>
        <style>
        @media (prefers-color-scheme: dark) {
             body { background: black;}
        }
        body {
            padding-top: env(safe-area-inset-top, 20px);
            padding-left: env(safe-area-inset-left, 20px);
        }
        .platform-ios.platform-cordova:not(.fullscreen) .bar-header:not(.bar-subheader) {
          height: 44px;
        }

        .platform-ios.platform-cordova:not(.fullscreen) .has-header, .platform-ios.platform-cordova:not(.fullscreen) .bar-subheader {
          top: 44px;
        }
        .platform-ios.platform-cordova:not(.fullscreen) .bar-header:not(.bar-subheader) > * {
          margin-top: 0px;
        }
        </style>

        <!-- ===================================== -->
        <!-- MobileCaddy Required Vendor Libraries -->
        <!-- ============================ -->
        <script src="{!URLFOR($Resource.MC_Resource_v2_2_3, 'jquery.min.js')}" type="text/javascript"></script>
        <script src="{!URLFOR($Resource.MC_Resource_v2_2_3, 'promise-1.0.0.min.js')}" type="text/javascript"></script>
        <script src="{!URLFOR($Resource.MC_Resource_v2_2_3, 'underscore-min.js')}" type="text/javascript"></script>

        <!-- ============================== -->
        <!-- MobileCaddy Core App Resources -->
        <!-- ============================== -->
        <script src="https://localhost/cordova.js"></script>

        <!-- ===================== -->
        <!-- MobileCaddy Libraries -->
        <!-- ===================== -->
        <script src="{!URLFOR($Resource.MC_Resource_v2_2_3, 'mobilecaddy-utils.min.js')}" type="text/javascript"></script>

        <!-- ================== -->
        <!-- Routing and Config -->
        <!-- ================== -->
        <!-- root of your app's content -->
        <script>window.RESOURCE_ROOT = "{!URLFOR($Resource.BioHub_3315, 'www/')}";</script>
        <script>window.LOCAL_DEV = false;</script>
        <script>window.USE_FORCETK = false;</script>

    </head>
    <body>

    <!-- ============================ -->
    <!-- App start page and structure -->
    <!-- ============================ -->
    <ion-nav-bar class="bar-light ng-hide">
      <ion-nav-back-button>
      </ion-nav-back-button>
    </ion-nav-bar>

    <ion-nav-view>
      <div id='start-page'>
        <div id='startlogo'>
        </div>
        <div class="card">
          <div class="item item-text-wrap">
            <p id='app-progress-msg' class="item-icon-left"><i class="icon spin ion-load-c"></i>The application is just being built... this may take a few moments.</p>
          </div>
        </div>
      </div>
    </ion-nav-view>

    <script type="text/javascript">
        function thirdPartyProgressCallbackB(val, tabCnt, tabNum){
            var infoStr = '';
            if ( tabCnt !== 0 ) {
                infoStr = '<i class="icon spin ion-load-c"></i>' + 'Building data table ' + val + '. ' + tabNum + ' of ' + tabCnt + '</p>';
            } else {
                infoStr = '<i class="icon spin ion-load-c"></i>' + 'Building app table ' + val + '.</p>';
            }
            document.getElementById("app-progress-msg").innerHTML = '<i class="icon spin ion-load-c"></i>' + 'Building table ' + val + '.</p>';
        };
    </script>

    <!-- ========================== -->
    <!-- MobileCaddy Startup Script -->
    <!-- ========================== -->
    <script type="text/javascript">

      document.addEventListener('deviceready', function(){
        // Pass controller name into mobile caddy
        mobileCaddy.START_PAGE_CONTROLLER = 'MobileCaddyStartPageController001_mc';

        // Get the mobileCaddy startup module
        var mobileCaddyStartup = mobileCaddy.require('mobileCaddy/startup');
        // Startup the app.  Parameter is custom callback function
        // or null if there is nothing custom to call on startup
        mobileCaddyStartup.startup(function(runUpInfo) {
          myapp_callback(runUpInfo);
        });
      }, false);
    </script>
    <!-- End MobileCaddy Startup Script -->
    <script type="text/javascript">
        Visualforce.remoting.last.maxRetries = 2;

        // Fix for iOS notch/keyboard issue - Case 5869
        var resetBodyPadding = () => {
          document.getElementsByTagName('body')[0].style = 'padding-top: 0px';
          setTimeout(function(){  document.getElementsByTagName('body')[0].style = 'padding-top: env(safe-area-inset-top, 20px)'; }, 10);
        }
        document.addEventListener('focusout', resetBodyPadding, false);
    </script>
  </body>
</apex:page>